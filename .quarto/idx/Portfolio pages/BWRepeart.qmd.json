{"title":"Between and Within Repeated Measures ANOVA in R","markdown":{"yaml":{"title":"Between and Within Repeated Measures ANOVA in R","editor":"visual","author":"Matthew Swanson","categories":["Repeated Measures ANOVA","R","Emmeans"],"warning":false,"message":false},"headingText":"**Project Goal**","containsRefs":false,"markdown":"\n\n::: text-center\n:::\n\nA researcher is interested in how memory for a list of words can be influenced by instructions on how to process the words. She assigns participants to one of three instruction conditions (COND): no instructions (coded as 1), rote memorization (told to just rehearse each word, coded as 2), and image (told to form an image for each word, coded as 3). Participants are presented with a list of 30 words and the researcher records the number out of 30 words that each participant recalls correctly. Because she is interested in practice effects, she presents each subject with two lists, one after another, and records performance on each list (LIST1 and LIST2).\n\nFirst, I will read in the data and check the data type (i.e., is the data wide or long?).\n\n```{r, echo=-7}\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ez)\nlibrary(tidyr)\nlibrary(tidyverse)\n\nData <- read_excel(\"C:/Users/matts/Desktop/WebsiteData/Data/Repeated Measures Data 2.xlsx\")\nhead(Data)\n\n#Need to convert data set to long format - it is currently in wide format\n\n#Changing data to long format - we want to gather by list as this is the repeated variable\nDataLong <- Data %>%\ngather(key = \"list\", value = \"score\", list1, list2)\nDataLong$list <- as.factor(DataLong$list)\nDataLong$cond <- as.factor(DataLong$cond)\nDataLong$subjid <- as.factor(DataLong$subjid)\nhead(DataLong)\n```\n\nNow, let's double check that the design is balanced.\n\n```{r}\nDataLong %>%\ngroup_by(list, cond) %>%\nsummarise(n = n(), sd = sd(score), var = var(score))\n```\n\n::: text-center\n# **Model Building**\n:::\n\nWe have a balanced design. Now let's analyze the data. We are interested in how memory for a list of words can be influenced by instructions on how to process the words.\n\n```{r}\nlibrary(rstatix)\nRepeated <- ezANOVA(DataLong, dv = score, wid = subjid, within = list, between = cond, detailed = TRUE, return_aov = TRUE, type = 3)\nRepeated\n\n#Additional ways to estimate this model\nModel <- aov(score ~ list*cond + Error(subjid/list), DataLong)\n#summary(Model)\n\n#SphereCorr <- anova_test(DataLong, dv = score, wid = subjid, within = list, between = cond)\n#SphereCorr\n\nlibrary(ggpubr)\n\nbxp <- ggboxplot(DataLong, x = \"list\", y = \"score\",color = \"cond\", palette = \"jco\")\nbxp\n```\n\nSince the interaction term is significant, F(2,27) = 5.94, p = .047, that means that values in one factor depend, in part, on the values in the other factor so we must look at pairwise comparisons (simple effects and simple effects comparison). As denoted in the figure and output, there are some significant mean memory score differences between list 1 and list 2 of words for each condition.\n\n::: text-center\n## **Marginal Means**\n:::\n\nLet's directly calculate these means and the marginal means to aid in our interpretation of this data.\n\n```{r}\nlibrary(emmeans)\n\n#the pairs function comes from the emmeans package - verbiage should feel similar to emmeans commands in SPSS\nSimpleCond <- emmeans(Model, pairwise ~ cond, adjust = \"bonferroni\")\nSimpleCond\n\nSimpleList <- emmeans(Model, pairwise ~ list, adjust = \"bonferroni\")\nSimpleList\n```\n\n::: text-center\n# **Solution**\n:::\n\nLet's interpret a few of these results. Across lists, participants told to form an image of the words in the mind recalled significantly greater words (M = 16.4) than those who practice rote memorization of the words (M = 12.2), t(27) = -2.86, p = 03. Additionally, the practice effect has strongest for participants in the rote memory condition as more words were recalled in the second list (M = 14.9) as compared to the first list (M = 9.4), t(27) = -7.43, p \\<.001. In other words, participants recalled more words overall when asked to assign an image to each word, however, they learned the best (i.e., the practice effect was the strongest) when they were asked to recall words via rote memory.\n","srcMarkdownNoYaml":"\n\n::: text-center\n# **Project Goal**\n:::\n\nA researcher is interested in how memory for a list of words can be influenced by instructions on how to process the words. She assigns participants to one of three instruction conditions (COND): no instructions (coded as 1), rote memorization (told to just rehearse each word, coded as 2), and image (told to form an image for each word, coded as 3). Participants are presented with a list of 30 words and the researcher records the number out of 30 words that each participant recalls correctly. Because she is interested in practice effects, she presents each subject with two lists, one after another, and records performance on each list (LIST1 and LIST2).\n\nFirst, I will read in the data and check the data type (i.e., is the data wide or long?).\n\n```{r, echo=-7}\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ez)\nlibrary(tidyr)\nlibrary(tidyverse)\n\nData <- read_excel(\"C:/Users/matts/Desktop/WebsiteData/Data/Repeated Measures Data 2.xlsx\")\nhead(Data)\n\n#Need to convert data set to long format - it is currently in wide format\n\n#Changing data to long format - we want to gather by list as this is the repeated variable\nDataLong <- Data %>%\ngather(key = \"list\", value = \"score\", list1, list2)\nDataLong$list <- as.factor(DataLong$list)\nDataLong$cond <- as.factor(DataLong$cond)\nDataLong$subjid <- as.factor(DataLong$subjid)\nhead(DataLong)\n```\n\nNow, let's double check that the design is balanced.\n\n```{r}\nDataLong %>%\ngroup_by(list, cond) %>%\nsummarise(n = n(), sd = sd(score), var = var(score))\n```\n\n::: text-center\n# **Model Building**\n:::\n\nWe have a balanced design. Now let's analyze the data. We are interested in how memory for a list of words can be influenced by instructions on how to process the words.\n\n```{r}\nlibrary(rstatix)\nRepeated <- ezANOVA(DataLong, dv = score, wid = subjid, within = list, between = cond, detailed = TRUE, return_aov = TRUE, type = 3)\nRepeated\n\n#Additional ways to estimate this model\nModel <- aov(score ~ list*cond + Error(subjid/list), DataLong)\n#summary(Model)\n\n#SphereCorr <- anova_test(DataLong, dv = score, wid = subjid, within = list, between = cond)\n#SphereCorr\n\nlibrary(ggpubr)\n\nbxp <- ggboxplot(DataLong, x = \"list\", y = \"score\",color = \"cond\", palette = \"jco\")\nbxp\n```\n\nSince the interaction term is significant, F(2,27) = 5.94, p = .047, that means that values in one factor depend, in part, on the values in the other factor so we must look at pairwise comparisons (simple effects and simple effects comparison). As denoted in the figure and output, there are some significant mean memory score differences between list 1 and list 2 of words for each condition.\n\n::: text-center\n## **Marginal Means**\n:::\n\nLet's directly calculate these means and the marginal means to aid in our interpretation of this data.\n\n```{r}\nlibrary(emmeans)\n\n#the pairs function comes from the emmeans package - verbiage should feel similar to emmeans commands in SPSS\nSimpleCond <- emmeans(Model, pairwise ~ cond, adjust = \"bonferroni\")\nSimpleCond\n\nSimpleList <- emmeans(Model, pairwise ~ list, adjust = \"bonferroni\")\nSimpleList\n```\n\n::: text-center\n# **Solution**\n:::\n\nLet's interpret a few of these results. Across lists, participants told to form an image of the words in the mind recalled significantly greater words (M = 16.4) than those who practice rote memorization of the words (M = 12.2), t(27) = -2.86, p = 03. Additionally, the practice effect has strongest for participants in the rote memory condition as more words were recalled in the second list (M = 14.9) as compared to the first list (M = 9.4), t(27) = -7.43, p \\<.001. In other words, participants recalled more words overall when asked to assign an image to each word, however, they learned the best (i.e., the practice effect was the strongest) when they were asked to recall words via rote memory.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"BWRepeart.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.333","editor":"visual","theme":{"light":"minty","dark":"solar"},"title":"Between and Within Repeated Measures ANOVA in R","author":"Matthew Swanson","categories":["Repeated Measures ANOVA","R","Emmeans"],"message":false},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}